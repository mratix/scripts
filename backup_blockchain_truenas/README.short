Einstieg & Betrieb
backup_blockchain_truenas.sh – Quick Overview
=============================================

Deterministic backup/verify/merge tool for blockchain nodes on TrueNAS.

ZFS-first Backup-Script für Blockchain-Nodes auf TrueNAS.
Entwickelt für Headless-Betrieb, Cronjobs und reale Produktionssysteme.

Dieses Script ist ein Admin-Werkzeug.
Kein Wizard, keine GUI, keine Magie.

Zweck:
-----
- Sichere Backups von Blockchain-Daten
- ZFS Snapshots als primäre Schutzschicht
- Rsync nur als Transportmittel
- Deterministisches Verhalten (headless-safe)


Features:
---------
- ZFS snapshot-first backups
- rsync-based backup & merge
- verify mode (size + compare)
- optional telemetry (Syslog / MySQL / Influx)
- hierarchical config system
- safe restore (interactive)

<<<<<<< HEAD
Status: Gold Release v1.1.4
-----------------------------------------------------------------------
=======
<<<<<<< ours
=======
Status: Gold Release v1.1.4
-----------------------------------------------------------------------
>>>>>>> theirs
>>>>>>> f631886 (	geändert:       LICENSE)

Supported Services:
-------------------

- bitcoind
- monerod
- chia (Farmer / Full Node / Plots – vorbereitet)
Weitere Services können ergänzt werden.


Betriebsmodi (MODE):
------------------_-
MODE=backup    Snapshot + Backup (Standard)
MODE=restore   Restore aus Backup (nur mit FORCE)
MODE=merge     Zusammenführen von Datasets (Snapshot-geschützt)
MODE=verify    reserviert


Konfiguration:
--------------
Konfiguration erfolgt über externe .conf-Dateien.
Diese werden in folgender Reihenfolge geladen (falls vorhanden):

1. config.conf        (optional, lokal)
2. default.conf       (global)
3. machine.conf       (rollenbasiert)
4. <hostname>.conf    (maschinen-spezifisch)

Jede .conf kann mit ENABLED=true|false aktiviert oder deaktiviert werden.
CLI-Variablen überschreiben Konfigurationswerte.


Pfad-Logik (vereinfachte Sicht):
--------------------------------
SRC_BASE   Basis der Quelldaten (z.B. /mnt/ssd/blockchain)
DEST_BASE  Basis der Backups    (z.B. /mnt/tank/backups/blockchain)
SRCDIR / DESTDIR können explizit gesetzt werden (Overrides, z.B. für Tests).


ZFS-Verhalten:
--------------
- Vor backup / merge / restore wird ein Snapshot erstellt
- Snapshot-Management (Retention, Replikation) erfolgt derzeit extern
- .zfs Verzeichnisse werden von rsync ausgeschlossen

Grundsatz: Snapshots sind die Wahrheit. Rsync ist nur ein Werkzeug.


Logging:
--------
Standard-Logfile: /var/log/blockchain_backup.log
Logging ist immer aktiv und sollte nicht entfernt werden.
Insbesondere bei headless-Betrieb mit machine.conf/<hostname>.conf


Minimaler Testlauf:
-------------------
./backup_blockchain_truenas.sh

das entspricht:
./backup_blockchain_truenas.sh --mode backup --service bitcoind
./backup_blockchain_truenas.sh SERVICE=bitcoind MODE=backup


Zielgruppe:
-----------

- Self-hosted Node-Betreiber
- Homelabs mit ZFS
- Admins, die Backups verstehen und anwenden möchten

Nicht geeignet für Klickibunti-Setups.
<<<<<<< HEAD

Weitere Details, Design-Entscheidungen und Philosophie:
siehe README.md
=======
<<<<<<< ours
Weitere Details, Design-Entscheidungen und Philosophie: siehe README.md

=======

Weitere Details, Design-Entscheidungen und Philosophie:
siehe README.md
>>>>>>> theirs
>>>>>>> f631886 (	geändert:       LICENSE)
